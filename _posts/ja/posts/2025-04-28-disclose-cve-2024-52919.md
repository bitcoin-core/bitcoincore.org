---
title: CVE-2024-52919 - メッセージスパムによるリモートクラッシュ（パート2）
name: blog-disclose-cve-2024-52919
id: ja-blog-disclose-cve-2024-52919
lang: ja
permalink: /ja/2025/04/28/disclose-cve-2024-52919/
type: advisory
layout: post

## If this is a new post, reset this counter to 1.
version: 1

## Only true if release announcement or security annoucement. English posts only
announcement: 0

excerpt: >
  攻撃者は、長期間にわたり`addr`メッセージをスパム送信することで、ノードをクラッシュさせる可能性があります。
  この問題の修正は、2025年4月14日にBitcoin Core v29.0でリリースされました。
---

ノードが長期間（数年）にわたりスパム`addr`メッセージを継続的に受信するとクラッシュを引き起こす整数オーバーフローバグの詳細を開示しました。
このバグの修正は、2025年4月14日にBitcoin Core v29.0でリリースされました。

この問題の重大度は**低**です。

## 詳細 {#details}

Bitcoin Coreのアドレスマネージャーは、エントリー毎に32-bitの識別子を使用し、
これはエントリーの挿入のたびにインクリメントされます。
[以前のセキュリティアドバイザリ](https://bitcoincore.org/ja/2024/07/31/disclose-addrman-int-overflow)では、
攻撃者が32-bitの識別子がオーバーフローするまでノードに`addr`メッセージをスパム送信することで、
リモートからアサーションエラーを誘発できると説明されていました。

この問題は、アドレスマネージャーへの挿入をピア毎に10秒に1アドレスに制限したことで、
Bitcoin Core v22.0で部分的に解決されました。これにより、攻撃のコストは大幅に増加し、実用的ではなくなりました。
1,000個のピアが継続的に攻撃したとしても、32-bitの識別子がオーバーフローするまでに1年以上かかることになります。

残った、よりコストのかかる攻撃ベクトルは、識別子を64-bitにすることで、Bitcoin Coreバージョン29.0で解決されました。

## 貢献 {#attribution}

この脆弱性を発見し公開したEugene Siegelと、識別子を64-bitに変更したMartin Zumsandeに感謝します。

## タイムライン {#timeline}

* 2021-06-21 - Eugene Siegelによる最初のレポートがsecurity@bitcoincore.orgに送信される
* 2021-07-19 - レート制限がPR[#22387](https://github.com/bitcoin/bitcoin/pull/22387)でマージされる
* 2021-09-13 - レート制限をともなうv22.0がリリースされる
* 2024-07-31 - [最初のセキュリティアドバイザリ](https://bitcoincore.org/ja/2024/07/31/disclose-addrman-int-overflow)の公開
* 2024-09-20 - 64-bit識別子への変更がPR[#30568](https://github.com/bitcoin/bitcoin/pull/30568)でマージされる
* 2025-04-14 - 64-bit識別子への変更がBitcoin Core v29.0でリリースされる
* 2025-04-28 - 公開

{% include references.md %}
